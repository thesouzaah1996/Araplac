<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Araplac M√≥veis ‚Ä¢ Almoxarifado de Manuten√ß√£o</title>

  <!-- Seguran√ßa -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; img-src 'self' data:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com; script-src 'self'; connect-src 'self' http://localhost:8080 https://localhost:8080;">
  <meta name="referrer" content="no-referrer">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="almoxarifado_manutencao.css" />
  <script src="almoxarifado_manutencao.js" defer></script>
</head>
<body>
  <!-- ===== Header / Topbar ===== -->
  <header class="topbar" role="banner">
    <div class="topbar-inner">
      <a class="brand" href="#" aria-label="Araplac M√≥veis - In√≠cio">
        <img src="img/logo.png" alt="Araplac M√≥veis" class="logo-transparent" />
        <div class="brand-text"></div>
      </a>

      <!-- Menu de usu√°rio (CSS-only via <details>) -->
      <div class="profile-area">
        <details class="profile" role="list">
          <summary class="avatar-btn" aria-label="Abrir menu da conta">
            <span class="avatar" aria-hidden="true">M</span>
          </summary>

          <nav class="menu" role="menu" aria-label="Menu do usu√°rio">
            <div class="menu-header">
              <strong id="userName">Matheus</strong>
              <small id="userEmail">usuario@empresa.com</small>
            </div>

            <a href="#" class="menu-item">Meu perfil</a>
            <a href="#" class="menu-item">Configura√ß√µes</a>
            <a href="#" class="menu-item">Central de ajuda</a>

            <!-- Bot√£o de logout (abre modal) -->
            <button role="menuitem" id="logoutBtn" class="menu-item danger">Sair</button>
          </nav>
        </details>
      </div>
    </div>
  </header>

  <!-- ===== Conte√∫do ===== -->
  <main class="container" role="main">
    <section class="card" aria-labelledby="tbl-title">
      <header class="card-header">
        <div>
          <h2 id="tbl-title">Controle de Estoque</h2>
        </div>

        <!-- Toolbar: bot√£o + busca -->
        <div class="toolbar">
          <button class="btn btn-primary" data-open="addModal" id="btnAdd">+ Adicionar item</button>

          <!-- NOVO: input de busca (somente UI, sem l√≥gica de backend aqui) -->
          <form class="search-form" role="search" onsubmit="return false">
            <input
              id="searchInput"
              class="search-input"
              type="search"
              name="q"
              placeholder="Buscar produtos..."
              aria-label="Buscar produtos"
              autocomplete="off"
            />
          </form>
        </div>
      </header>

      <div class="table-wrapper" role="region" aria-label="Tabela de itens do almoxarifado" tabindex="0">
        <table class="data-table" id="table">
          <thead>
            <tr>
              <th scope="col">C√≥digo</th>
              <th scope="col">Descri√ß√£o</th>
              <th scope="col">Categoria</th>
              <th scope="col">Unidade</th>
              <th scope="col">Quantidade</th>
              <th scope="col">Localiza√ß√£o</th>
              <th scope="col">Status</th>
              <th scope="col">√öltima Mov.</th>
              <th scope="col" class="col-actions">A√ß√µes</th>
            </tr>
          </thead>
          <tbody id="tbody"><!-- preenchido via JS --></tbody>
        </table>

        <!-- Pagina√ß√£o (8 por p√°gina) -->
        <div id="pagination" class="pagination" aria-label="Pagina√ß√£o"></div>
      </div>
    </section>
  </main>

  <!-- ===== Footer ===== -->
  <footer class="app-footer" role="contentinfo">
    <small class="copyright">¬© 2025 Araplac M√≥veis ‚Äî Almoxarifado de Manuten√ß√£o</small>
  </footer>

  <!-- Overlay ‚Äúfilme‚Äù para o logout -->
  <div id="filmOverlay" aria-hidden="true"></div>

  <!-- ===== Modal: Adicionar ===== -->
  <div class="modal" id="addModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="addTitle">
    <div class="modal-card">
      <header class="modal-header">
        <h3 id="addTitle">Adicionar produto</h3>
        <button class="icon-btn" data-close aria-label="Fechar">√ó</button>
      </header>
      <form id="formAdd" class="grid" autocomplete="off">
        <input name="codigo" placeholder="C√≥digo (ex: MT-0100)" required />
        <input name="descricao" placeholder="Descri√ß√£o" required />
        <select name="categoria" required>
          <option value="" selected disabled>Categoria</option>
          <option value="MATERIA_PRIMA">Mat√©ria-prima</option>
          <option value="FERRAGEM">Ferragem</option>
          <option value="ACABAMENTO">Acabamento</option>
          <option value="CONSUMIVEIS">Consum√≠veis</option>
          <option value="EMBALAGENS">Embalagens</option>
          <option value="EPI">EPI</option>
        </select>
        <input name="unidade" placeholder="Unidade (un, par, m¬≤...)" required />
        <input name="quantidade" type="number" min="0" placeholder="Quantidade" required />
        <input name="localizacao" placeholder="Localiza√ß√£o" required />
        <input name="ultimaMov" type="date" required />
        <input name="responsavelRecebimento" type="text" placeholder="Respons√°vel pelo recebimento" required>
        <div class="modal-actions">
          <button type="button" class="btn" data-close>Cancelar</button>
          <button class="btn btn-primary" type="submit">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ===== Modal: Editar ===== -->
  <div class="modal" id="editModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="editTitle">
    <div class="modal-card">
      <header class="modal-header">
        <h3 id="editTitle">Editar produto</h3>
        <button class="icon-btn" data-close aria-label="Fechar">√ó</button>
      </header>
      <form id="formEdit" class="grid" autocomplete="off">
        <input type="hidden" name="id" />
        <input name="codigo" placeholder="C√≥digo" required />
        <input name="descricao" placeholder="Descri√ß√£o" required />
        <select name="categoria" required>
          <option value="" selected disabled>Categoria</option>
          <option value="MATERIA_PRIMA">Mat√©ria-prima</option>
          <option value="FERRAGEM">Ferragem</option>
          <option value="ACABAMENTO">Acabamento</option>
          <option value="CONSUMIVEIS">Consum√≠veis</option>
          <option value="EMBALAGENS">Embalagens</option>
          <option value="EPI">EPI</option>
        </select>
        <input name="unidade" placeholder="Unidade" required />
        <input name="quantidade" type="number" min="0" placeholder="Quantidade" required />
        <input name="localizacao" placeholder="Localiza√ß√£o" required />
        <input name="ultimaMov" type="date" required />
        <input name="responsavelRecebimento" placeholder="Respons√°vel pelo recebimento" />
        <div class="modal-actions">
          <button type="button" class="btn" data-close>Cancelar</button>
          <button class="btn btn-primary" type="submit">Atualizar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ===== Modal: Ver Detalhes ===== -->
  <div class="modal" id="viewModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="viewTitle">
    <div class="modal-card modal-card-lg">
      <header class="modal-header vh-header">
        <div class="vh-top">
          <div class="vh-icon" aria-hidden="true">üì¶</div>
          <div class="vh-title">
            <h3 id="viewTitle">Detalhes do produto</h3>
            <div class="vh-sub"><span class="chip" id="vhCodigoChip">‚Äî</span></div>
          </div>
        </div>
        <button class="icon-btn" data-close aria-label="Fechar">√ó</button>
      </header>

      <div class="vh-meta">
        <span id="vhStatus"  class="pill">Status</span>
        <span id="vhUnidade" class="pill">Unidade</span>
      </div>

      <hr class="divider"/>

      <ul class="kv-list" role="list">
        <li class="kv-row"><span class="kv-key">C√≥digo</span><span class="kv-val" id="vCodigo"></span></li>
        <li class="kv-row"><span class="kv-key">Descri√ß√£o</span><span class="kv-val" id="vDescricao"></span></li>
        <li class="kv-row"><span class="kv-key">Categoria</span><span class="kv-val" id="vCategoria"></span></li>
        <li class="kv-row"><span class="kv-key">Unidade</span><span class="kv-val" id="vUnidade"></span></li>
        <li class="kv-row"><span class="kv-key">Quantidade</span><span class="kv-val" id="vQuantidade"></span></li>
        <li class="kv-row"><span class="kv-key">Localiza√ß√£o</span><span class="kv-val" id="vLocalizacao"></span></li>
        <li class="kv-row"><span class="kv-key">√öltima Movimenta√ß√£o</span><span class="kv-val" id="vUltimaMov"></span></li>
        <li class="kv-row"><span class="kv-key">Respons√°vel</span><span class="kv-val" id="vResp"></span></li>
      </ul>

      <div class="modal-actions end">
        <button class="btn" data-close>Fechar</button>
      </div>
    </div>
  </div>

  <!-- ===== Modal: Logout ===== -->
  <div class="modal" id="logoutModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="logoutTitle">
    <div class="modal-card modal-sm">
      <header class="modal-header">
        <h3 id="logoutTitle">Encerrar sess√£o</h3>
        <button class="icon-btn" data-close aria-label="Fechar">√ó</button>
      </header>
      <p>Tem certeza que deseja sair?</p>
      <div class="modal-actions">
        <button class="btn" data-close>Cancelar</button>
        <button class="btn btn-danger" id="confirmLogout">Sair</button>
      </div>
    </div>
  </div>

  <!-- ===== Modal: Excluir ===== -->
  <div class="modal" id="deleteModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="delTitle">
    <div class="modal-card">
      <header class="modal-header">
        <h3 id="delTitle">Remover produto</h3>
        <button class="icon-btn" data-close aria-label="Fechar">√ó</button>
      </header>
      <p>Tem certeza que deseja remover o produto <strong id="delItem"></strong>?</p>
      <div class="modal-actions">
        <button class="btn" data-close>Cancelar</button>
        <button class="btn btn-danger" id="confirmDelete">Remover</button>
      </div>
    </div>
  </div>
</body>
</html>
